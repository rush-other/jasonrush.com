<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<head>
  <title>Jason Rush: Rule Engine</title>

  <script type="text/javascript">(function() { var a=window;function f(e){this.t={};this.tick=function(d,b,c){var i=c?c:(new Date).getTime();this.t[d]=[i,b]};this.tick("start",null,e)}var g=new f;a.jstiming={Timer:f,load:g};try{a.jstiming.pt=a.external.pageT}catch(h){};a.tickAboveFold=function(e){var d,b=e,c=0;if(b.offsetParent){do c+=b.offsetTop;while(b=b.offsetParent)}d=c;d<=750&&a.jstiming.load.tick("aft")};var j=false;function k(){if(!j){j=true;a.jstiming.load.tick("firstScrollTime")}}a.addEventListener?a.addEventListener("scroll",k,false):a.attachEvent("onscroll",k); })();</script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="MSSmartTagsPreventParsing" content="true" />
<meta name="generator" content="Blogger" />
<link rel="icon" type="image/vnd.microsoft.icon" href="http://www.blogger.com/favicon.ico"/>
<link rel="alternate" type="application/atom+xml" title="Jason Rush - Atom" href="http://jasonrush.com/blog/atom.xml" />
<link rel="alternate" type="application/rss+xml" title="Jason Rush - RSS" href="http://jasonrush.com/blog/rss.xml" />
<link rel="service.post" type="application/atom+xml" title="Jason Rush - Atom" href="http://www.blogger.com/feeds/4653046199291468715/posts/default" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.blogger.com/rsd.g?blogID=4653046199291468715" />
<link rel="alternate" type="application/atom+xml" title="Jason Rush - Atom" href="http://www.blogger.com/feeds/4653046199291468715/2670895596062204200/comments/default" />
 <link rel="stylesheet" type="text/css" href="http://www.blogger.com/static/v1/v-css/3727950723-blog_controls.css"/> <link rel="stylesheet" type="text/css" href="http://www.blogger.com/dyn-css/authorization.css?targetBlogID=4653046199291468715&zx=caf1702e-0fa0-4006-8dec-4b9298adfcff"/>

  <style type="text/css">
/*
-----------------------------------------------
Blogger Template Style
Name:     Minima
Designer: Douglas Bowman
URL:      www.stopdesign.com
Date:     26 Feb 2004
----------------------------------------------- */


body {
  background:#fff;
  margin:0;
  padding:40px 20px;
  font:x-small Georgia,Serif;
  text-align:center;
  color:#333;
  font-size/* */:/**/small;
  font-size: /**/small;
  }
a:link {
  color:#58a;
  text-decoration:none;
  }
a:visited {
  color:#969;
  text-decoration:none;
  }
a:hover {
  color:#c60;
  text-decoration:underline;
  }
a img {
  border-width:0;
  }


/* Header
----------------------------------------------- */
@media all {
  #header {
    width:660px;
    margin:0 auto 10px;
    border:1px solid #ccc;
    }
  }
@media handheld {
  #header {
    width:90%;
    }
  }
#blog-title {
  margin:5px 5px 0;
  padding:20px 20px .25em;
  border:1px solid #eee;
  border-width:1px 1px 0;
  font-size:200%;
  line-height:1.2em;
  font-weight:normal;
  color:#666;
  text-transform:uppercase;
  letter-spacing:.2em;
  }
#blog-title a {
  color:#666;
  text-decoration:none;
  }
#blog-title a:hover {
  color:#c60;
  }
#description {
  margin:0 5px 5px;
  padding:0 20px 20px;
  border:1px solid #eee;
  border-width:0 1px 1px;
  max-width:700px;
  font:78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#999;
  }

/* Content
----------------------------------------------- */
@media all {
  #content {
    width:660px;
    margin:0 auto;
    padding:0;
    text-align:left;
    }
  #main {
    width:410px;
    float:left;
    }
  #sidebar {
    width:220px;
    float:right;
    }
  }
@media handheld {
  #content {
    width:90%;
    }
  #main {
    width:100%;
    float:none;
    }
  #sidebar {
    width:100%;
    float:none;
    }
  }

/* Headings
----------------------------------------------- */
h2 {
  margin:1.5em 0 .75em;
  font:78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#999;
  }


/* Posts
----------------------------------------------- */
@media all {
  .date-header {
    margin:1.5em 0 .5em;
    }
  .post {
    margin:.5em 0 1.5em;
    border-bottom:1px dotted #ccc;
    padding-bottom:1.5em;
    }
  }
@media handheld {
  .date-header {
    padding:0 1.5em 0 1.5em;
    }
  .post {
    padding:0 1.5em 0 1.5em;
    }
  }
.post-title {
  margin:.25em 0 0;
  padding:0 0 4px;
  font-size:140%;
  font-weight:normal;
  line-height:1.4em;
  color:#c60;
  }
.post-title a, .post-title a:visited, .post-title strong {
  display:block;
  text-decoration:none;
  color:#c60;
  font-weight:normal;
  }
.post-title strong, .post-title a:hover {
  color:#333;
  }
.post div {
  margin:0 0 .75em;
  line-height:1.6em;
  }
p.post-footer {
  margin:-.25em 0 0;
  color:#ccc;
  }
.post-footer em, .comment-link {
  font:78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
.post-footer em {
  font-style:normal;
  color:#999;
  margin-right:.6em;
  }
.comment-link {
  margin-left:.6em;
  }
.post img {
  padding:4px;
  border:1px solid #ddd;
  }
.post blockquote {
  margin:1em 20px;
  }
.post blockquote p {
  margin:.75em 0;
  }


/* Comments
----------------------------------------------- */
#comments h4 {
  margin:1em 0;
  font:bold 78%/1.6em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#999;
  }
#comments h4 strong {
  font-size:130%;
  }
#comments-block {
  margin:1em 0 1.5em;
  line-height:1.6em;
  }
#comments-block dt {
  margin:.5em 0;
  }
#comments-block dd {
  margin:.25em 0 0;
  }
#comments-block dd.comment-timestamp {
  margin:-.25em 0 2em;
  font:78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
#comments-block dd p {
  margin:0 0 .75em;
  }
.deleted-comment {
  font-style:italic;
  color:gray;
  }
.paging-control-container {
  float: right;
  margin: 0px 6px 0px 0px;
  font-size: 80%;
}
.unneeded-paging-control {
  visibility: hidden;
}

/* Sidebar Content
----------------------------------------------- */
#sidebar ul {
  margin:0 0 1.5em;
  padding:0 0 1.5em;
  border-bottom:1px dotted #ccc;
  list-style:none;
  }
#sidebar li {
  margin:0;
  padding:0 0 .25em 15px;
  text-indent:-15px;
  line-height:1.5em;
  }
#sidebar p {
  color:#666;
  line-height:1.5em;
  }


/* Profile
----------------------------------------------- */
#profile-container {
  margin:0 0 1.5em;
  border-bottom:1px dotted #ccc;
  padding-bottom:1.5em;
  }
.profile-datablock {
  margin:.5em 0 .5em;
  }
.profile-img {
  display:inline;
  }
.profile-img img {
  float:left;
  padding:4px;
  border:1px solid #ddd;
  margin:0 8px 3px 0;
  }
.profile-data {
  margin:0;
  font:bold 78%/1.6em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
.profile-data strong {
  display:none;
  }
.profile-textblock {
  margin:0 0 .5em;
  }
.profile-link {
  margin:0;
  font:78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }


/* Footer
----------------------------------------------- */
#footer {
  width:660px;
  clear:both;
  margin:0 auto;
  }
#footer hr {
  display:none;
  }
#footer p {
  margin:0;
  padding-top:15px;
  font:78%/1.6em "Trebuchet MS",Trebuchet,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }


/* Feeds
----------------------------------------------- */
#blogfeeds {
  }
#postfeeds {
  }
  </style>

</head>

<body>

<div id="header">

  <h1 id="blog-title">
    <a href="http://jasonrush.com/blog/">
	Jason Rush
	</a>
  </h1>
  <p id="description"></p>

</div>

<!-- Begin #content -->
<div id="content">


<!-- Begin #main -->
<div id="main"><div id="main2">



    
  <h2 class="date-header">Monday, February 16, 2009</h2>
  

  
     
  <!-- Begin .post -->
  <div class="post"><a name="2670895596062204200"></a>
         
    <h3 class="post-title">
	 
	 Rule Engine
	 
    </h3>
    

	         <div class="post-body">
	<div>
      <div style="clear:both;"></div>So I am basically at the point now where I have a functioning rule engine for the logic games project.  It's all out on <a href="http://github.com/diminish7/logic-games/tree/master"><span class="blsp-spelling-error" id="SPELLING_ERROR_0">github</span></a>.  Here's the gist of it:<br /><br />The class structure is described <a href="http://jasonrush.com/images/logic_games_UML.jpg">here</a>, from a few posts ago.  The rule evaluation is the new part.  The <span class="blsp-spelling-error" id="SPELLING_ERROR_1">RuleBase</span> stores a list of Facts, which are in a hash keyed by the Entity and the Property to which they apply.<br /><br />A Clause can be evaluated by determining if there is a Fact with the same information.  So the Clause's truth is evaluated by looking at the <span class="blsp-spelling-error" id="SPELLING_ERROR_2">RuleBase's</span> facts hash with the Clause's Entity and Property.  If a Fact is found for that Entity and Property, and the Fact's property_value and <span class="blsp-spelling-corrected" id="SPELLING_ERROR_3">comparator</span> match those of the Clause, then the Clause evaluates as TRUE.  If the Fact's property_value matches that of the Clause, but the <span class="blsp-spelling-corrected" id="SPELLING_ERROR_4">comparator</span> is NOT equal to the Clause's, then the Clause evaluates as FALSE.  In all other situations, the Clause evaluates as UNKNOWN.<br /><br />A <span class="blsp-spelling-error" id="SPELLING_ERROR_5">ClauseCluster</span> is evaluated by looking at the <span class="blsp-spelling-error" id="SPELLING_ERROR_6">rhs</span> and <span class="blsp-spelling-error" id="SPELLING_ERROR_7">lhs</span> (right hand side and left hand side of the clause) and using the operator to perform Boolean logic.  So if the operator is AND, then the <span class="blsp-spelling-error" id="SPELLING_ERROR_8">lhs</span> and <span class="blsp-spelling-error" id="SPELLING_ERROR_9">rhs</span> must both be TRUE for the <span class="blsp-spelling-error" id="SPELLING_ERROR_10">ClauseCluster</span> to evaluate to TRUE, and if the operator is OR, then the <span class="blsp-spelling-error" id="SPELLING_ERROR_11">lhs</span> and the <span class="blsp-spelling-error" id="SPELLING_ERROR_12">rhs</span> must both be FALSE for the <span class="blsp-spelling-error" id="SPELLING_ERROR_13">ClauseCluster</span> to evaluate to FALSE.  If the truth of the <span class="blsp-spelling-error" id="SPELLING_ERROR_14">ClauseCluster</span> can't be determined (for example, if the operator is AND and the <span class="blsp-spelling-error" id="SPELLING_ERROR_15">lhs</span> is TRUE but the <span class="blsp-spelling-error" id="SPELLING_ERROR_16">rhs</span> is UNKNOWN, then the <span class="blsp-spelling-error" id="SPELLING_ERROR_17">ClauseCluster</span> evaluates to UNKNOWN.<br /><br />Rule's are evaluated by evaluating the Clause or <span class="blsp-spelling-error" id="SPELLING_ERROR_18">ClauseCluster</span> that is the antecedent.  All the work is delegated to the antecedent's evaluation method.  The interesting part of the Rule's evaluation is what happens after the truth of the antecedent is determined.  If the antecedent is TRUE, then a new Fact gets added to the <span class="blsp-spelling-error" id="SPELLING_ERROR_19">RuleBase's</span> facts hash based on the consequent.  If the antecedent is TRUE or FALSE (i.e. not UNKNOWN), then a flag gets set marking the Rule as having been fired.<br /><br />The <span class="blsp-spelling-error" id="SPELLING_ERROR_20">RuleEngine</span> gets evaluated by evaluating all of its Rules.  It iterates over all of its Rules, evaluating any Rule that has not already been fired (i.e. who's truth is still UNKNOWN) until either a) all Rules have been fired, or b) the remaining unfired Rules cannot be evaluated because we don't have enough information.  In the case of the latter, this is determined by completing a full iteration without inferring any new knowledge.  So if all Rules get evaluated, and no new Facts get generated, then the no new Facts will be generated in the next iteration either, so we can stop trying.<br /><br />My next step is to start putting together a suite of tests that represent real logic games data.  For right now, I am going to manually convert a set of logic games into sets of Rules and Facts just to test out the rule engine.  After that, the really hard work begins: parsing a logic game, turning natural language into a set of Rules.<div style="clear:both; padding-bottom:0.25em"></div>
    </div>
    </div>
    
    <p class="post-footer">
      <em>posted by Jason at 
    <a class="post-footer-link" href="http://jasonrush.com/blog/2009/02/rule-engine.html" title="permanent link"> 5:55 PM </a></em>
        <span class="item-control blog-admin pid-1176500513"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4653046199291468715&postID=2670895596062204200" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 
  <div id="comments">

	<a name="comments"></a>
    <h4>0 Comments:</h4>
    <dl id="comments-block">
      
      
      
    </dl>
		<p class="comment-timestamp">
      <a class="comment-link" href="https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=2670895596062204200">Post a Comment</a>
    </p>
    <p id="postfeeds"></p>
  
    


		<p class="comment-timestamp">
	<a href="http://jasonrush.com/blog/">&lt;&lt; Home</a>
    </p>
    </div>



  <!-- End #comments -->

<script type="text/javascript" src="http://www.blogger.com/static/v1/common/js/327583163-csitaillib.js"></script>
<script>if (typeof(window.attachCsiOnload) != 'undefined' && window.attachCsiOnload != null) { window.attachCsiOnload('ext_blogspot'); }</script>
</div></div>
<!-- End #main -->







<!-- Begin #sidebar -->
<div id="sidebar"><div id="sidebar2">
  
  
  <!-- Begin #profile-container -->

   <div id="profile-container"><h2 class="sidebar-title">About Me</h2>
<dl class="profile-datablock"><dt class="profile-img"><a href="http://www.blogger.com/profile/16806243609100183836"><img src="http://2.bp.blogspot.com/_SIexhu2TcNI/SRd_w9JJIBI/AAAAAAAAAAM/Bl6IVRMN6xo/S220/jason.jpg" width="53" height="80" alt="My Photo"></a></dt>
<dd class="profile-data"><strong>Name:</strong>  Jason Rush </dd>
<dd class="profile-data"><strong>Location:</strong>  Santa Monica, CA, United States </dd></dl>

<p class="profile-link"><a href="http://www.blogger.com/profile/16806243609100183836">View my complete profile</a></p></div>
   
  <!-- End #profile -->
    
        

  <iframe src="http://www.clappies.com/widgets/26" frameborder="0" width="60" height="50"></iframe> 
  <h2 class="sidebar-title">Previous Posts</h2>
    <ul id="recently">
    
        <li><a href="http://jasonrush.com/blog/2009/01/finally-some-progress.html">Finally, Some Progress</a></li>
     
        <li><a href="http://jasonrush.com/blog/2009/01/crazy-busy.html">Crazy Busy...</a></li>
     
        <li><a href="http://jasonrush.com/blog/2008/12/rule-grammar-persistence.html">Rule Grammar Persistence</a></li>
     
        <li><a href="http://jasonrush.com/blog/2008/11/brute-force.html">Brute Force</a></li>
     
        <li><a href="http://jasonrush.com/blog/2008/11/logic-games-project.html">Logic Games Project</a></li>
     
        <li><a href="http://jasonrush.com/blog/2008/11/welcome-to-jasons-blog.html">Welcome to Jason&#39;s Blog</a></li>
     
  </ul>
    

      <p id="powered-by"><a href="http://www.blogger.com"><img src="http://buttons.blogger.com/bloggerbutton1.gif" alt="Powered by Blogger" /></a></p>
      <p id="blogfeeds">Subscribe to<br/>Posts [<a target="_blank" href="http://jasonrush.com/blog/atom.xml" type="application/atom+xml">Atom</a>]</p>
  
  <!--
  <p>This is a paragraph of text that could go in the sidebar.</p>
  -->
  


</div></div>
<!-- End #sidebar -->


</div>
<!-- End #content -->



<!-- Begin #footer -->
<div id="footer"><hr />
  <p><!--This is an optional footer. If you want text here, place it inside these tags, and remove this comment. -->&nbsp;</p>

</div>
<!-- End #footer -->



</body>
</html>