<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
<head>
  <title>Jason Rush</title>

  <script type="text/javascript">(function() { var a=window;function e(b){this.t={};this.tick=function(c,h,d){d=d?d:(new Date).getTime();this.t[c]=[d,h]};this.tick("start",null,b)}var f=new e;a.jstiming={Timer:e,load:f};try{a.jstiming.pt=a.gtbExternal&&a.gtbExternal.pageT()||a.external&&a.external.pageT}catch(g){};a.tickAboveFold=function(b){b=b;var c=0;if(b.offsetParent){do c+=b.offsetTop;while(b=b.offsetParent)}b=c;b<=750&&a.jstiming.load.tick("aft")};var i=false;function j(){if(!i){i=true;a.jstiming.load.tick("firstScrollTime")}}a.addEventListener?a.addEventListener("scroll",j,false):a.attachEvent("onscroll",j); })();</script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="MSSmartTagsPreventParsing" content="true" />
<meta name="generator" content="Blogger" />
<link rel="icon" type="image/vnd.microsoft.icon" href="http://www.blogger.com/favicon.ico"/>
<link rel="alternate" type="application/atom+xml" title="Jason Rush - Atom" href="http://jasonrush.com/blog/atom.xml" />
<link rel="alternate" type="application/rss+xml" title="Jason Rush - RSS" href="http://jasonrush.com/blog/rss.xml" />
<link rel="service.post" type="application/atom+xml" title="Jason Rush - Atom" href="http://www.blogger.com/feeds/4653046199291468715/posts/default" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.blogger.com/rsd.g?blogID=4653046199291468715" />
 <link rel="stylesheet" type="text/css" href="http://www.blogger.com/static/v1/v-css/3727950723-blog_controls.css"/> <link rel="stylesheet" type="text/css" href="http://www.blogger.com/dyn-css/authorization.css?targetBlogID=4653046199291468715&zx=1593423e-d35b-49b5-b89f-183864227af5"/>

  <style type="text/css">
/*
-----------------------------------------------
Blogger Template Style
Name:     Minima
Designer: Douglas Bowman
URL:      www.stopdesign.com
Date:     26 Feb 2004
----------------------------------------------- */


body {
  background:#fff;
  margin:0;
  padding:40px 20px;
  font:x-small Georgia,Serif;
  text-align:center;
  color:#333;
  font-size/* */:/**/small;
  font-size: /**/small;
  }
a:link {
  color:#58a;
  text-decoration:none;
  }
a:visited {
  color:#969;
  text-decoration:none;
  }
a:hover {
  color:#c60;
  text-decoration:underline;
  }
a img {
  border-width:0;
  }


/* Header
----------------------------------------------- */
@media all {
  #header {
    width:660px;
    margin:0 auto 10px;
    border:1px solid #ccc;
    }
  }
@media handheld {
  #header {
    width:90%;
    }
  }
#blog-title {
  margin:5px 5px 0;
  padding:20px 20px .25em;
  border:1px solid #eee;
  border-width:1px 1px 0;
  font-size:200%;
  line-height:1.2em;
  font-weight:normal;
  color:#666;
  text-transform:uppercase;
  letter-spacing:.2em;
  }
#blog-title a {
  color:#666;
  text-decoration:none;
  }
#blog-title a:hover {
  color:#c60;
  }
#description {
  margin:0 5px 5px;
  padding:0 20px 20px;
  border:1px solid #eee;
  border-width:0 1px 1px;
  max-width:700px;
  font:78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#999;
  }

/* Content
----------------------------------------------- */
@media all {
  #content {
    width:660px;
    margin:0 auto;
    padding:0;
    text-align:left;
    }
  #main {
    width:410px;
    float:left;
    }
  #sidebar {
    width:220px;
    float:right;
    }
  }
@media handheld {
  #content {
    width:90%;
    }
  #main {
    width:100%;
    float:none;
    }
  #sidebar {
    width:100%;
    float:none;
    }
  }

/* Headings
----------------------------------------------- */
h2 {
  margin:1.5em 0 .75em;
  font:78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#999;
  }


/* Posts
----------------------------------------------- */
@media all {
  .date-header {
    margin:1.5em 0 .5em;
    }
  .post {
    margin:.5em 0 1.5em;
    border-bottom:1px dotted #ccc;
    padding-bottom:1.5em;
    }
  }
@media handheld {
  .date-header {
    padding:0 1.5em 0 1.5em;
    }
  .post {
    padding:0 1.5em 0 1.5em;
    }
  }
.post-title {
  margin:.25em 0 0;
  padding:0 0 4px;
  font-size:140%;
  font-weight:normal;
  line-height:1.4em;
  color:#c60;
  }
.post-title a, .post-title a:visited, .post-title strong {
  display:block;
  text-decoration:none;
  color:#c60;
  font-weight:normal;
  }
.post-title strong, .post-title a:hover {
  color:#333;
  }
.post div {
  margin:0 0 .75em;
  line-height:1.6em;
  }
p.post-footer {
  margin:-.25em 0 0;
  color:#ccc;
  }
.post-footer em, .comment-link {
  font:78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
.post-footer em {
  font-style:normal;
  color:#999;
  margin-right:.6em;
  }
.comment-link {
  margin-left:.6em;
  }
.post img {
  padding:4px;
  border:1px solid #ddd;
  }
.post blockquote {
  margin:1em 20px;
  }
.post blockquote p {
  margin:.75em 0;
  }


/* Comments
----------------------------------------------- */
#comments h4 {
  margin:1em 0;
  font:bold 78%/1.6em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.2em;
  color:#999;
  }
#comments h4 strong {
  font-size:130%;
  }
#comments-block {
  margin:1em 0 1.5em;
  line-height:1.6em;
  }
#comments-block dt {
  margin:.5em 0;
  }
#comments-block dd {
  margin:.25em 0 0;
  }
#comments-block dd.comment-timestamp {
  margin:-.25em 0 2em;
  font:78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
#comments-block dd p {
  margin:0 0 .75em;
  }
.deleted-comment {
  font-style:italic;
  color:gray;
  }
.paging-control-container {
  float: right;
  margin: 0px 6px 0px 0px;
  font-size: 80%;
}
.unneeded-paging-control {
  visibility: hidden;
}

/* Sidebar Content
----------------------------------------------- */
#sidebar ul {
  margin:0 0 1.5em;
  padding:0 0 1.5em;
  border-bottom:1px dotted #ccc;
  list-style:none;
  }
#sidebar li {
  margin:0;
  padding:0 0 .25em 15px;
  text-indent:-15px;
  line-height:1.5em;
  }
#sidebar p {
  color:#666;
  line-height:1.5em;
  }


/* Profile
----------------------------------------------- */
#profile-container {
  margin:0 0 1.5em;
  border-bottom:1px dotted #ccc;
  padding-bottom:1.5em;
  }
.profile-datablock {
  margin:.5em 0 .5em;
  }
.profile-img {
  display:inline;
  }
.profile-img img {
  float:left;
  padding:4px;
  border:1px solid #ddd;
  margin:0 8px 3px 0;
  }
.profile-data {
  margin:0;
  font:bold 78%/1.6em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }
.profile-data strong {
  display:none;
  }
.profile-textblock {
  margin:0 0 .5em;
  }
.profile-link {
  margin:0;
  font:78%/1.4em "Trebuchet MS",Trebuchet,Arial,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }


/* Footer
----------------------------------------------- */
#footer {
  width:660px;
  clear:both;
  margin:0 auto;
  }
#footer hr {
  display:none;
  }
#footer p {
  margin:0;
  padding-top:15px;
  font:78%/1.6em "Trebuchet MS",Trebuchet,Verdana,Sans-serif;
  text-transform:uppercase;
  letter-spacing:.1em;
  }


/* Feeds
----------------------------------------------- */
#blogfeeds {
  }
#postfeeds {
  }
  </style>

<link rel="me" href="http://www.blogger.com/profile/16806243609100183836" />
<link rel="openid.server" href="http://www.blogger.com/openid-server.g" />
</head>

<body>

<div id="header">

  <h1 id="blog-title">
    
	Jason Rush
	
  </h1>
  <p id="description"></p>

</div>

<!-- Begin #content -->
<div id="content">


<!-- Begin #main -->
<div id="main"><div id="main2">



    
  <h2 class="date-header">Sunday, December 13, 2009</h2>
  

  
     
  <!-- Begin .post -->
  <div class="post"><a name="7841616094462024116"></a>
         
    <h3 class="post-title">
	 
	 Rave: Back at it
	 
    </h3>
    

	         <div class="post-body">
	<div>
      <div style="clear:both;"></div>Last year, I started working on a JRuby port of the Google Wave robot API called Rave.  I took a bit of a hiatus from working on Rave, since the Google Wave API was a bit unstable, and I had been spinning my wheels trying to solve some things that turned out to be unsolvable...  Anyway, the Wave API has stabilized a bit, so I'm back at it. And I have some help - a couple of people have been contributing code to the project.  Which is, by the way, awesome.<br /><br />Anyway, I'll post more on Rave pretty soon. In the mean time, check it out on <a href="http://github.com/diminish7/rave">Github</a>, for more info. Particularly the README.<span style="text-decoration: underline;"></span><a href="http://github.com/diminish7/rave"><br /></a><div style="clear:both; padding-bottom:0.25em"></div>
    </div>
    </div>
    
    <p class="post-footer">
      <em>posted by Jason at 
    <a class="post-footer-link" href="http://jasonrush.com/blog/2009/12/rave-back-at-it.html" title="permanent link"> 5:08 PM </a></em>
      

         <a class="comment-link" href="https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=7841616094462024116"location.href=https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=7841616094462024116;><span style="text-transform:lowercase">0 Comments</span></a>

      
  <span class="item-control blog-admin pid-1176500513"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4653046199291468715&postID=7841616094462024116" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 

  <!-- End #comments -->



    
  <h2 class="date-header">Sunday, November 22, 2009</h2>
  

  
     
  <!-- Begin .post -->
  <div class="post"><a name="1104134379639078738"></a>
         
    <h3 class="post-title">
	 
	 Vendor Jars
	 
    </h3>
    

	         <div class="post-body">
	<div>
      <div style="clear:both;"></div>I'm hanging out at JRubyConf today, and I got all inspired to contribute something to the community.  So I decided to put together a little plugin for auto-loading jars into a JRuby on Rails project.  One of the key advantages of using JRuby instead of MRI is the availability of all of the mature Java libraries.  In JRuby, you have the ability to easily wrap those libraries and access them directly from your Ruby code.  The process is pretty easy, you just require each jar that you want to use, just like you'd require a gem, or another .rb file.  But there is no consistent pattern for this -- no convention for where to place those files.  What I wanted was to have a jars folder under <span style="font-style: italic;">vendor</span> where you could just drop jars and have them automatically required in your app.  The end result is a ridiculously simple plugin I've imaginatively called <a href="http://github.com/diminish7/vendor_jars">Vendor Jars</a>. <br /><br />To install it, just cd to the top-level folder of your rails app and run<br /><blockquote><pre>script/plugin install git://github.com/diminish7/vendor_jars.git</pre></blockquote>This will add the plugin to your <span style="font-style: italic;">vendor/plugins</span> folder, and it will create a <span style="font-style: italic;">vendor/jars</span> folder.  Then, for any Java jar that you want to be accessible from your JRuby code, just drop the jar into that <span style="font-style: italic;">vendor/jars</span> folder, and it will automatically get required at startup.<br /><br />That's it.  I know it's not much (it's like 4 lines of code or something) but I feel like I write that same code every time I do a new JRuby app, so, simple as it is, I think it'll be useful.<div style="clear:both; padding-bottom:0.25em"></div>
    </div>
    </div>
    
    <p class="post-footer">
      <em>posted by Jason at 
    <a class="post-footer-link" href="http://jasonrush.com/blog/2009/11/vendor-jars.html" title="permanent link"> 9:15 PM </a></em>
      

         <a class="comment-link" href="https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=1104134379639078738"location.href=https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=1104134379639078738;><span style="text-transform:lowercase">0 Comments</span></a>

      
  <span class="item-control blog-admin pid-1176500513"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4653046199291468715&postID=1104134379639078738" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 

  <!-- End #comments -->



    
  <h2 class="date-header">Sunday, September 13, 2009</h2>
  

  
     
  <!-- Begin .post -->
  <div class="post"><a name="4180116617097024336"></a>
         
    <h3 class="post-title">
	 
	 Taking a Break from Rave
	 
    </h3>
    

	         <div class="post-body">
	<div>
      <div style="clear:both;"></div>I've had a frustrating couple of weeks working on <a href="http://github.com/diminish7/rave/tree">Rave</a>. Rave is a Ruby port of the <a href="http://wave-robot-python-client.googlecode.com/svn/trunk/pydocs/index.html">Python API</a> for building robots in <a href="http://wave.google.com/">Google Wave</a>. Wave is pretty unstable, and so I keep running into problems where I'll spend hours debugging my code only to determine that it's a problem with Wave. So I'm going to set it aside for a little while. In about a month, Google is going to release new versions of everything, and start letting the general public sign up for Wave accounts. I assume that they are planning on having a more stable version of Wave at that point. So, I'll revisit it then. As it stands, Rave is in a pretty good spot for building a lot of types of robots. The two big things I've been fighting with recently are that the capabilities versioning doesn't work correctly (so Wave caches your robot's capabilities and you can't add or remove capabilities in new versions), and cron events don't work. I'll revisit both of those in October once a more stable version of Wave is out. Until then, I need to stop spinning my wheels and start focusing on some side projects that I can make some actual progress on.<div style="clear:both; padding-bottom:0.25em"></div>
    </div>
    </div>
    
    <p class="post-footer">
      <em>posted by Jason at 
    <a class="post-footer-link" href="http://jasonrush.com/blog/2009/09/taking-break-from-rave.html" title="permanent link"> 1:07 PM </a></em>
      

         <a class="comment-link" href="https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=4180116617097024336"location.href=https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=4180116617097024336;><span style="text-transform:lowercase">0 Comments</span></a>

      
  <span class="item-control blog-admin pid-1176500513"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4653046199291468715&postID=4180116617097024336" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 

  <!-- End #comments -->



    
  <h2 class="date-header">Sunday, June 21, 2009</h2>
  

  
     
  <!-- Begin .post -->
  <div class="post"><a name="151131889078347837"></a>
         
    <h3 class="post-title">
	 
	 Rave: Google Wave Robots in Ruby
	 
    </h3>
    

	         <div class="post-body">
	<div>
      <div style="clear:both;"></div><span style="font-weight: bold;font-size:130%;" >Google Wave</span><br />There's been a lot of talk about Google Wave lately, so what's Wave all about?  Wave is a <a href="http://www.waveprotocol.org/">protocol</a>, that extends XMPP.  In practice, it contains elements of email, instant messaging and threaded discussion. Oh, and document management. Yeah, it seems to do just about everything.  The problem with that is that it makes it really hard to describe.  It always sounds like it is trying to be everything - to solve every problem.  But really, it's all about online collaborative communication. Here, take a look at the <a href="http://www.youtube.com/watch?v=v_UyVmITiYQ">demo from the Google I/O keynote</a> this year.  It makes more sense once you've seen it in action.<br /><br />Wave is in an alpha release right now.  As far as I know, only the attendees of Google I/O have accounts on the sandbox.  Hopefully that will change before too long.  Google's only saying that it will be released "before the end of the year" right now.  In the mean time, there's a ton of information on the main <a href="http://wave.google.com/">Wave </a>site, the <a href="http://www.waveprotocol.org/draft-protocol-spec">wave protocol </a>site, and the <a href="http://googleblog.blogspot.com/2009/05/went-walkabout-brought-back-google-wave.html">Google blog</a>.<br /><br /><span style="font-size:130%;"><span style="font-weight: bold;">Some Terminology</span></span><br />There are three primary components to Google Wave: <span style="font-style: italic;">waves</span>, <span style="font-style: italic;">wavelets </span>and <span style="font-style: italic;">blips</span>. <span style="font-style: italic;">Waves </span>are the central component. Think of a <span style="font-style: italic;">wave </span>as a conversation.  A <span style="font-style: italic;">wave </span>has one or more <span style="font-style: italic;">wavelets</span>, which are sort of like sub-conversations, or threads of discussion under a conversation.  Finally, <span style="font-style: italic;">blips </span>are the actual messages in the discussion, so a <span style="font-style: italic;">wavelet </span>can contain one or more <span style="font-style: italic;">blips</span>.  There's a better description of these terms in <a href="http://www.waveprotocol.org/draft-protocol-spec#wavelets">the protocol spec</a>.<br /><br /><span style="font-weight: bold;font-size:130%;" >Wasn't This Post Supposed to be About Robots?</span><br />Here's what's really cool about Google Wave: there's an API for building extensions for it.  There are three things that a developer can do with Wave: embed a wave on a website, build gadgets to be embedded in a wave, and build robots.  There's a discussion on each of these on the <a href="http://code.google.com/apis/wave/">Wave API</a> site.  My focus here is going to be on robots, because let's face it, robots are awesome.<br /><br />Robots are automated participants in a wave.  They can do basically anything that a human participant can do: they can read the conversation, add to the conversation, and they can edit a conversation.  So you can, for example, build a spell checker that reads everthing you post to a wave and edits it to change typos as you type.  There are some cool examples of things you can do with robots in the <a href="http://www.youtube.com/watch?v=v_UyVmITiYQ">Google I/O keynote demo</a>.<br /><br /><span style="font-size:130%;"><span style="font-weight: bold;">Google Wave Robot Tools</span></span><br />Google released two toolkits for building robots, one in <a href="http://code.google.com/apis/wave/extensions/robots/java-tutorial.html">Java</a>, and one in <a href="http://code.google.com/apis/wave/extensions/robots/python-tutorial.html">Python</a>.  Furthermore, there is currently a restriction in place that requires robots to live on <a href="http://code.google.com/appengine/">Google App Engine</a>. So that means that a robot has to either be in Python or Java...  or some other language implemented on the JVM.  Happily, for those of us who prefer to code in Ruby, we've got JRuby.  Now all we need is an implementation of the robot client API in Ruby.<br /><br /><span style="font-size:130%;"><span style="font-weight: bold;">Rave: A Google Wave robot client framework for Ruby</span></span><br />There are several parallel efforts to create a Ruby implementation of the robot API. The rest of this post is going to focus on <a href="http://github.com/diminish7/rave">Rave</a>, but I just wanted to link to the other implementations that I'm aware of:<br /><ul><li>Sam Ruby's <a href="http://github.com/rubys/wave-robot-ruby-client">Wave Robot Ruby Client</a></li><li>Jack Danger's <a aiotarget="false" aiotitle="Wave" href="http://github.com/JackDanger/wave">Wave</a></li><li>Mike Sofaer's <a href="http://github.com/MikeSofaer/Wave-Robot-Sinatra-Template">Wave Robot Sinatra Template</a></li></ul><span style="font-size:130%;"><span style="font-weight: bold;">Warning!</span></span><br />Both Rave and Google Wave are super-alpha. There are a lot of things in the protocol that aren't implemented in Rave yet. And the protocol is changing, so the things that are implemented are likely to break at some point. I will try to keep up, but if you notice anything broken, or if you have a need for something that isn't implemented yet, shoot me an email: diminish7 at gmail dot com.<br /><br />Okay.  You've been warned.<br />   <br /><span style="font-size:130%;"><span style="font-weight: bold;">The Basics</span></span><br />Since Google currently requires that all robots run on App Engine, this tutorial assumes you are using JRuby. You should have JRuby already installed, and you should have the App Engine SDK installed.  You can find more information on JRuby at <a href="http://jruby.org/">http://jruby.org/</a>, and you can find more information about the App Engine SDK at <a href="http://code.google.com/appengine/downloads.html">http://code.google.com/appengine/downloads.html</a><br /><br /><span style="font-size:130%;"><span style="font-weight: bold;">What We're Going to Build</span></span><br />I hate it when people yell in writing.  I want a robot that will moniter discussions and tone down any yelling.  So, for example, this robot will turn a post like "I'M NOT YELLING!!!!" into "I'm not yelling."  The full source for this robot is in <a href="http://github.com/diminish7/rave">git</a> under examples/appropriate-casey/.  Here's how you build it yourself:<br /><br /><span style="font-size:130%;"><span style="font-weight: bold;">Install Rave</span></span><br /><pre><br />   sudo jruby -S gem install rave<br /></pre><br /><span style="font-weight: bold;font-size:130%;" >Start a new Rave Project</span><br />Rave comes with a "rave" executable that, among other things, sets up the project structure for you.  Setting up a new project looks like this:<br /><pre><br />   jruby -S rave create [robot_name] [options]<br /></pre><br />The options include profile_url and image_url, which will set the URL for the robot's profile and avatar, respectively. Here's how the example project "appropriate casey" was set up:<br /><pre><br />   jruby -S rave create appropriate-casey<br /></pre><br />I haven't bothered to create an avatar for casey, but if I had, I would instead have done:<br /><pre><br />  jruby -S rave create appropriate-casey image_url=http://myimageurl/avatar.png<br /></pre><br />This will stub out a project called "appropriate-casey".  It automatically creates a robot class AppropriateCasey, creates the config files for both <a href="http://rack.rubyforge.org/">Rack</a> and <a href="http://caldersphere.rubyforge.org/warbler/">Warbler</a>, and creates the appengine-web.xml file that App Engine will need.  For the App Engine file, it assumes that the App Engine project name is the same as the robot's name.  So in this case, the application name is appropriate-casey, which means I have to have the URL http://appropriate-casey.appspot.com.  If you name your robot something different than the App Engine application ID, just change the <application> line in appengine-web.xml.<br /><br /><span style="font-size:130%;"><span style="font-weight: bold;">Build your robot!</span></span><br />The robot.rb file that Rave created contains a class that extends Rave::Models::Robot. All of the logic needed for your robot to talk to App Engine is included in Rave::Models::Robot, so all you really need to do now is define your robot's event listeners.  Here is a list of the events that Google Wave can send your robot:<br /><ul><li> WAVELET_BLIP_CREATED</li><li>WAVELET_BLIP_REMOVED</li><li>WAVELET_PARTICIPANTS_CHANGED</li><li>WAVELET_TIMESTAMP_CHANGED</li><li>WAVELET_TITLE_CHANGED</li><li>WAVELET_VERSION_CHANGED</li><li>BLIP_CONTRIBUTORS_CHANGED</li><li>BLIP_DELETED</li><li>BLIP_SUBMITTED</li><li>BLIP_TIMESTAMP_CHANGED</li><li>BLIP_VERSION_CHANGED</li><li>DOCUMENT_CHANGED</li><li>FORM_BUTTON_CLICKED<br /></li></ul>To add a listener to your robot that will respond to a given event, just define a method with the lower-case version of the event name, that accepts an event and a context.  So, I want appropriate-casey to do something whenever a document is changed (the DOCUMENT_CHANGED event), so I add the following method to my robot:<br /><pre><br />   def document_changed(event, context)<br />      # Do some stuff<br />   end<br /></pre><br />The Event object contains the following properties:<br /><ul><li>type (the type of event, "DOCUMENT_CHANGED" in this case)</li><li>timestamp (the timestamp that the event occurred)</li><li>modified_by (the user ID of the user who modified the document)</li><li>properties (varies by event type, but this will be a range of affected text in this case)<br /></li></ul>The Context object contains the following properties:<br /><ul><li> waves (a hash - the keys are the wave IDs, and the values are the waves)</li><li> wavelets (a hash - the keys are the wavelet IDs, and the values are the wavelets)</li><li> blips (a hash - the keys are the blip IDs, and the values are the blips)</li><li> operations (an array of operations)</li></ul>See the <a href="http://www.waveprotocol.org/draft-protocol-spec">Google Wave protocol documentation</a> for definitions of each of these things...<br /><br />So, with Appropriate Casey, I want to create a robot that looks for people "shouting" in Waves. To do this, I just create a document_changed method in my robot that looks something like this:<br /><pre><br />   def document_changed(event, context)<br />     unless event.modified_by == "appropriate-casey@appspot.com" || <br />            event.modified_by == "spelly@gwave.com"<br />        context.blips.values.each do |blip|<br />          if blip.content<br />            new_sentence = true<br />            blip.content.length.times do |index|<br />              range = index..index+1<br />              char = blip.content[index, 1]<br />              if char =~ /[A-Z]/ && !new_sentence<br />                blip.set_text_in_range(range, char.downcase)<br />              elsif char =~ /[a-z]/ && new_sentence<br />                blip.set_text_in_range(range, char.upcase)<br />              elsif char == "!"<br />                if new_sentence<br />                  blip.delete_range(range)<br />                else<br />                  blip.set_text_in_range(range, ".")<br />                end<br />              end<br />              new_sentence = (char =~ /\.!?/ || (char =~ /\s/ && new_sentence))<br />            end<br />          end<br />        end<br />      end<br />   end<br /></pre>  <br />For simplicity's sake, I'm brute-forcing this a bit. It would be better to look at the event properties and just change the range of text that the event is telling me about.<br /><br />So that's it, my robot is now ready to go: just 17 lines of code.<br /><br /><span style="font-size:130%;"><span style="font-weight: bold;">Packaging for deploy</span></span><br />I'm assuming that you have an application set up on App Engine already.  Again, for the time being, all robots have to be on App Engine to work with Google Wave.<br /><br />First of all, we need to turn our project into the correct format for App Engine.  There is a utility<br />in the "rave" executable for this, so from your robot's top-level folder, run:<br /><pre><br />   jruby -S rave war<br /></pre><br />This is basically just a wrapper around the <a href="http://caldersphere.rubyforge.org/warbler/">warbler</a> gem, but with some additional cleanup to get things in the right format for App Engine.  For example, the complete JRuby jar is too large for App Engine, so Rave breaks it up into two jars.  Once you've run "rave war", you'll see a tmp/ folder, and a .war file.  You can ignore the .war file, as App Engine needs the unpacked version. The tmp/war folder is what will get deployed.<br /><br /><span style="font-size:130%;"><span style="font-weight: bold;">Testing</span></span><br />The worst part about App Engine is testing...<br /><br />Rave includes a "server" command that starts up Rack for your application, but that is of limited use, since App Engine has many App Engine-specific issues. Better to use the App Engine SDK (which is still not a perfect match to the deployed environment, but it's better).  The App Engine SDK comes with a dev_server command.  From your project directory run:<br /><pre><br />   path/to/appengine_sdk/bin/dev_server tmp/war<br /></pre><br />This will start the development server on port 8080.  You can now hit the following three URLs:<br /><ul><li>  <a href="http://localhost:8080/_wave/capabilities.xml">http://localhost:8080/_wave/capabilities.xml</a></li><li>  <a href="http://localhost:8080/_wave/robot/profile">http://localhost:8080/_wave/robot/profile</a></li><li>  <a href="http://localhost:8080/_wave/robot/jsonrpc">http://localhost:8080/_wave/robot/jsonrpc</a></li></ul>The first two are GETs, but the last one requires a POST. See the <a href="http://www.waveprotocol.org/draft-protocol-spec">Google Wave protocol</a> for the expected body of the POST if you want to test locally.<br /><br /><span style="font-size:130%;"><span style="font-weight: bold;">Deploying</span></span><br />Use the App Engine SDK to deploy.  From your project directory run:<br /><pre><br />  path/to/appengine_sdk/bin/appcfg update tmp/war<br /></pre><br /><span style="font-size:130%;"><span style="font-weight: bold;">Using the Robot</span></span><br />From a Google Wave client, start a new wave, and invite your robot as a participant.  Your robot's user name will be [robot_name]@appspot.com.  So Casey is at appropriate-casey@appspot.com.<br /><br /><span style="font-weight: bold;">The End</span><br />That's it.  You now have a working robot!  Enjoy!<div style="clear:both; padding-bottom:0.25em"></div>
    </div>
    </div>
    
    <p class="post-footer">
      <em>posted by Jason at 
    <a class="post-footer-link" href="http://jasonrush.com/blog/2009/06/rave-google-wave-robots-in-ruby.html" title="permanent link"> 10:03 AM </a></em>
      

         <a class="comment-link" href="https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=151131889078347837"location.href=https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=151131889078347837;><span style="text-transform:lowercase">4 Comments</span></a>

      
  <span class="item-control blog-admin pid-1176500513"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4653046199291468715&postID=151131889078347837" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 

  <!-- End #comments -->



    
  <h2 class="date-header">Tuesday, June 16, 2009</h2>
  

  
     
  <!-- Begin .post -->
  <div class="post"><a name="5715362740605969648"></a>
         
    <h3 class="post-title">
	 
	 Moonstone
	 
    </h3>
    

	         <div class="post-body">
	<div>
      <div style="clear:both;"></div>We recently open-sourced Moonstone, our JRuby wrapper around Lucene, the Java search engine toolkit.  Moonstone is simple, and easy to use - it lets you put together a powerful search engine quickly.  It gives you the full capabilities of Lucene, but replaces the Java-isms with a more Ruby-ish syntax.  I wanted to take a quick minute to run through the basics:<br /><br /><span style="font-weight: bold;">Installation</span><br /><pre>    sudo jruby -S gem install moonstone<br /></pre>Note that if you are on Windows, drop the "sudo".  Also, for the record, no one's ever tested Moonstone on Windows.  But since it's all JRuby and Java, there shouldn't be any issues...<br /><br />If you want the source, you can get it from <a href="http://github.com/automatthew/moonstone/tree/master">automatthew's github repo</a>.<br /><br /><span style="font-weight: bold;">Engines</span><br /><br />Creating an engine requires two things: a doc_from method and an analyzer.<br /><pre><br />  class SimplestEngine < Moonstone::Engine<br />    def doc_from(record)<br />      doc = Lucene::Document::Doc.new<br />      doc.add_field('name', record[:name])<br />      doc.add_field('desc', record[:description])<br />      doc<br />    end<br />   def analyzer<br />     @analyzer ||= Lucene::Analysis::WhitespaceAnalyzer.new<br />   end<br /> end    <br /> # We can now instantiate the engine<br /> engine = SimplestEngine.new<br /> # and create an index of some data<br /> records = [<br />     {:name => "Moonstone", :description => "A simple JRuby wrapper around Lucene"},<br />     {:name => "Foo", :description => "A search engine based on Moonstone"}<br />   ]<br /> # By convention the index method accepts an Enumerable that yields hashes<br /> engine.index(records)<br /><br /> #Search for data<br /> q = Lucene::Search::TermQuery.new("name", "Moonstone")<br /> documents = engine.search(q)<br /> documents.each {|d| puts d['name']}<br /></pre>That's it in a nutshell.  There are some more examples in the README on github, and more documentation is coming soon.<br /><br />Happy searching!<div style="clear:both; padding-bottom:0.25em"></div>
    </div>
    </div>
    
    <p class="post-footer">
      <em>posted by Jason at 
    <a class="post-footer-link" href="http://jasonrush.com/blog/2009/06/moonstone.html" title="permanent link"> 6:03 PM </a></em>
      

         <a class="comment-link" href="https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=5715362740605969648"location.href=https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=5715362740605969648;><span style="text-transform:lowercase">0 Comments</span></a>

      
  <span class="item-control blog-admin pid-1176500513"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4653046199291468715&postID=5715362740605969648" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 

  <!-- End #comments -->



    
  <h2 class="date-header">Tuesday, May 12, 2009</h2>
  

  
     
  <!-- Begin .post -->
  <div class="post"><a name="1320617763945966086"></a>
         
    <h3 class="post-title">
	 
	 Beholder: A Ruby Template Engine
	 
    </h3>
    

	         <div class="post-body">
	<div>
      <div style="clear:both;"></div>I started up a new project to create a template engine for Ruby web apps.  The beginnings of it are on github <a href="http://github.com/diminish7/beholder/tree/master">here</a>.  It's very, very rough, so don't judge yet. :-)<br /><br />I know there are a ton of template engines out there.  But here's my complaint with them: often the person developing the front end of an app is primarily an HTML/CSS/JavaScript developer.  They may not know Ruby at all.  So template engines like Markaby and Hoshi are out.  ERB is the most HTML-like template engine, but a) it's still got Ruby mixed into it, so it isn't ideal for strictly front-end developers, and b) it's a mixture of Ruby and HTML, which is ugly and spaghetti-ish.<br /><br />Enter Beholder.<br /><br />Beholder is a template engine comprised of HTML tags.  Dynamic behavior is accomplished through the use attributes.  So, for example, if you have a page and you want to show a chunk of it conditionally, you could do something like this:<br /><blockquote>&#060;html><br />    &#060;head><br />        &#060;title>Hello World&#060;/title><br />    &#060;/head><br />    &#060;body><br />        &#060;span component="if" condition="true"><br />            Body of 'if' component<br />        &#060;/span><br />        &#060;span component="elsif" condition="true"><br />            Body of 'elsif' component<br />        &#060;/span><br />        &#060;span component="else"><br />            Body of 'else' component<br />        &#060;/span><br />    &#060;/body><br />&#060;/html><br /></blockquote>Which would be rendered as:<br /><blockquote>&#060;html><br />    &#060;head><br />        &#060;title>Hello World&#060;/title><br />    &#060;/head><br />    &#060;body><br />            Body of 'if' component<br />    &#060;/body><br />&#060;/html></blockquote><blockquote></blockquote>The 'component' attribute can either refer to a built in control flow structure, such as 'if', or 'foreach', or it can refer to a partial, so you can embed mini-beholder templates in your main template.  There is also a 'yield' component, so each component can act like a layout, generating it's HTML, and then yielding the content within the component node in the template.<br /><br />In addition, any attribute can be made dynamically by including the 'prop:' prefix.  So if you have a template like this:<br /><blockquote>&#060;html><br />    &#060;head><br />        &#060;title>Hello World&#060;/title><br />    &#060;/head><br />    &#060;body><br />        &#060;span component="simple_component" message_class="beholder" /><br />    &#060;/body><br />&#060;/html><span component="simple_component" message_class="beholder"><br /></span></blockquote>And a partial called simple_component.beh like this:<br /><blockquote>&#060;p class="prop:message_class">What's up, world?&#060;/p><br /></blockquote>It would be rendered like this:<br /><blockquote><blockquote>&#060;html><br />    &#060;head><br />        &#060;title>Hello World&#060;/title><br />    &#060;/head><br />    &#060;body><br />        &#060;p class="beholder">What's up, world?&#060;/p><br />    &#060;/body><br />&#060;/html><span component="simple_component" message_class="beholder"><br /></span></blockquote></blockquote>The 'prop:' prefixed attributes get evaluated as (in this order) a) the value of the parent component's attribute with that name, b) the value of a local variable of that name, or c) a method in the helper class.  (Note that I've only implemented a) right now... so you'll just have to trust me that that's where I'm going.)<br /><br />This is modeled after <a href="http://tapestry.apache.org/">Tapestry </a>templates (Java) and <a href="http://www.kid-templating.org/">Kid </a>templates (Python).  Anyway, there's a lot of work to be done on it (particularly around the evaluation of 'prop:' attributes), but I like the idea of it a lot.<br /><blockquote></blockquote><blockquote></blockquote><blockquote></blockquote><div style="clear:both; padding-bottom:0.25em"></div>
    </div>
    </div>
    
    <p class="post-footer">
      <em>posted by Jason at 
    <a class="post-footer-link" href="http://jasonrush.com/blog/2009/05/beholder-ruby-template-engine.html" title="permanent link"> 9:28 PM </a></em>
      

         <a class="comment-link" href="https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=1320617763945966086"location.href=https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=1320617763945966086;><span style="text-transform:lowercase">0 Comments</span></a>

      
  <span class="item-control blog-admin pid-1176500513"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4653046199291468715&postID=1320617763945966086" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 

  <!-- End #comments -->



    
  <h2 class="date-header">Sunday, May 3, 2009</h2>
  

  
     
  <!-- Begin .post -->
  <div class="post"><a name="7007738027708279559"></a>
         
    <h3 class="post-title">
	 
	 Ruby HTML Template Engines
	 
    </h3>
    

	         <div class="post-body">
	<div>
      <div style="clear:both;"></div>I've been thinking a bit about template engines in Ruby.  There's a ton of them out there.  <a href="http://www.hokstad.com/mini-reviews-of-19-ruby-template-engines.html">Here's</a> a good review of a bunch of them.  We generally use either <a href="http://debu.gs/hoshi"><span class="blsp-spelling-error" id="SPELLING_ERROR_0">Hoshi</span> </a>or <a href="http://markaby.rubyforge.org/"><span class="blsp-spelling-error" id="SPELLING_ERROR_1">Markaby</span></a> at my job right now.  For our purposes, these have been great.  We all work on all aspects of a project, from front to back, and we'd all rather write Ruby than HTML.  However, in several jobs I've had, we've had a front-end developer doing all the HTML and <span class="blsp-spelling-error" id="SPELLING_ERROR_2">CSS</span>.  The problem is that people who really specialize in front-end development often don't know Ruby.  So <span class="blsp-spelling-error" id="SPELLING_ERROR_3">Hoshi</span> and <span class="blsp-spelling-error" id="SPELLING_ERROR_4">Markaby</span> are out.  In those situations, we've used <span class="blsp-spelling-error" id="SPELLING_ERROR_5">ERB</span> templates.  But then you've got Ruby and HTML mixed together, and that's never pretty.  What I'd really like is a template engine that just looks like HTML, with no Ruby mixed into it.  Something along the lines of Python's <a href="http://www.kid-templating.org/">Kid</a>, or Java's <a href="http://tapestry.apache.org/">Tapestry</a> templates.  I've been looking around a bit and haven't found anything like that yet in Ruby.  Sounds like time to spin up a new project!  More to come...<div style="clear:both; padding-bottom:0.25em"></div>
    </div>
    </div>
    
    <p class="post-footer">
      <em>posted by Jason at 
    <a class="post-footer-link" href="http://jasonrush.com/blog/2009/05/ruby-html-template-engines.html" title="permanent link"> 7:35 PM </a></em>
      

         <a class="comment-link" href="https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=7007738027708279559"location.href=https://www.blogger.com/comment.g?blogID=4653046199291468715&postID=7007738027708279559;><span style="text-transform:lowercase">0 Comments</span></a>

      
  <span class="item-control blog-admin pid-1176500513"><a style="border:none;" href="http://www.blogger.com/post-edit.g?blogID=4653046199291468715&postID=7007738027708279559" title="Edit Post"><img class="icon-action" alt="" src="http://www.blogger.com:80/img/icon18_edit_allbkg.gif" height="18" width="18"></a></span>
    </p>
  
  </div>
  <!-- End .post -->
  
  
  
  <!-- Begin #comments -->
 

  <!-- End #comments -->

<script type="text/javascript" src="http://www.blogger.com/static/v1/common/js/1499043574-csitaillib.js"></script>
<script>if (typeof(window.attachCsiOnload) != 'undefined' && window.attachCsiOnload != null) { window.attachCsiOnload('ext_blogspot'); }</script>
</div></div>
<!-- End #main -->







<!-- Begin #sidebar -->
<div id="sidebar"><div id="sidebar2">
  
  
  <!-- Begin #profile-container -->

   <div id="profile-container"><h2 class="sidebar-title">About Me</h2>
<dl class="profile-datablock"><dt class="profile-img"><a href="http://www.blogger.com/profile/16806243609100183836"><img src="http://2.bp.blogspot.com/_SIexhu2TcNI/SRd_w9JJIBI/AAAAAAAAAAM/Bl6IVRMN6xo/S220/jason.jpg" width="53" height="80" alt="My Photo"></a></dt>
<dd class="profile-data"><strong>Name:</strong>  Jason Rush </dd>
<dd class="profile-data"><strong>Location:</strong>  Boulder, CO, United States </dd></dl>

<p class="profile-link"><a href="http://www.blogger.com/profile/16806243609100183836">View my complete profile</a></p></div>
   
  <!-- End #profile -->
    
        
    
  

  <iframe src="http://www.clappies.com/widgets/26" frameborder="0" width="60" height="50"></iframe> 
  <h2 class="sidebar-title">Previous Posts</h2>
    <ul id="recently">
    
        <li><a href="http://jasonrush.com/blog/2009/12/rave-back-at-it.html">Rave: Back at it</a></li>
     
        <li><a href="http://jasonrush.com/blog/2009/11/vendor-jars.html">Vendor Jars</a></li>
     
        <li><a href="http://jasonrush.com/blog/2009/09/taking-break-from-rave.html">Taking a Break from Rave</a></li>
     
        <li><a href="http://jasonrush.com/blog/2009/06/rave-google-wave-robots-in-ruby.html">Rave: Google Wave Robots in Ruby</a></li>
     
        <li><a href="http://jasonrush.com/blog/2009/06/moonstone.html">Moonstone</a></li>
     
        <li><a href="http://jasonrush.com/blog/2009/05/beholder-ruby-template-engine.html">Beholder: A Ruby Template Engine</a></li>
     
        <li><a href="http://jasonrush.com/blog/2009/05/ruby-html-template-engines.html">Ruby HTML Template Engines</a></li>
     
        <li><a href="http://jasonrush.com/blog/2009/04/more-logic-games.html">More Logic Games</a></li>
     
        <li><a href="http://jasonrush.com/blog/2009/04/logic-games-almost-there.html">Logic Games: Almost There!</a></li>
     
        <li><a href="http://jasonrush.com/blog/2009/04/start-of-dsl.html">The Start of a DSL</a></li>
     
  </ul>
    

  <h2 class="sidebar-title">Archives</h2>
    <ul class="archive-list">
   	  
    	<li><a href="http://jasonrush.com/blog/2008_11_01_archive.html">November 2008</a></li>
	  
    	<li><a href="http://jasonrush.com/blog/2008_12_01_archive.html">December 2008</a></li>
	  
    	<li><a href="http://jasonrush.com/blog/2009_01_01_archive.html">January 2009</a></li>
	  
    	<li><a href="http://jasonrush.com/blog/2009_02_01_archive.html">February 2009</a></li>
	  
    	<li><a href="http://jasonrush.com/blog/2009_04_01_archive.html">April 2009</a></li>
	  
    	<li><a href="http://jasonrush.com/blog/2009_05_01_archive.html">May 2009</a></li>
	  
    	<li><a href="http://jasonrush.com/blog/2009_06_01_archive.html">June 2009</a></li>
	  
    	<li><a href="http://jasonrush.com/blog/2009_09_01_archive.html">September 2009</a></li>
	  
    	<li><a href="http://jasonrush.com/blog/2009_11_01_archive.html">November 2009</a></li>
	  
    	<li><a href="http://jasonrush.com/blog/2009_12_01_archive.html">December 2009</a></li>
	  

  </ul>
  

      <p id="powered-by"><a href="http://www.blogger.com"><img src="http://buttons.blogger.com/bloggerbutton1.gif" alt="Powered by Blogger" /></a></p>
      <p id="blogfeeds">Subscribe to<br/>Posts [<a target="_blank" href="http://jasonrush.com/blog/atom.xml" type="application/atom+xml">Atom</a>]</p>
  
  <!--
  <p>This is a paragraph of text that could go in the sidebar.</p>
  -->
  


</div></div>
<!-- End #sidebar -->


</div>
<!-- End #content -->



<!-- Begin #footer -->
<div id="footer"><hr />
  <p><!--This is an optional footer. If you want text here, place it inside these tags, and remove this comment. -->&nbsp;</p>

</div>
<!-- End #footer -->



</body>
</html>